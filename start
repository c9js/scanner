#!/bin/bash
#┌────────────────┐
#│ Список пакетов │
#└────────────────┘
PACKAGES=(
    linux-headers # Заголовки ядра для сборки C-модулей
)

#┌──────────────────────┐
#│ Устанавливает пакеты │
#└──────────────────────┘
install_packages() {
# Локальные переменные
    local pkg
    
# Проходим по списку пакетов
    for pkg in "${PACKAGES[@]}"; do
    # Устанавливаем пакет
        apk add "$pkg" > /dev/null 2>&1 || {
            echo 'Ошибка!'
            echo "Не удалось установить пакет: $pkg"
            exit 1
        }
    done
}

#┌──────────────────────┐
#│ Устанавливаем пакеты │
#└──────────────────────┘
echo '1/3 Устанавливаем пакеты...'
# install_packages

#┌─────────────────┐
#│ Собираем проект │
#└─────────────────┘
echo '2/3 Собираем проект...'
npx node-gyp@10.3.1 configure build || {
    echo 'Ошибка!'
    echo "Не удалось собрать проект!"
    exit 1
}

#┌───────────────┐
#│ Проект собран │
#└───────────────┘
echo '3/3 Проект собран!'
